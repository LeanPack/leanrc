_             = require 'lodash'
joi           = require 'joi'
inflect       = require('i')()
{ db }        = require '@arangodb'
queues        = require '@arangodb/foxx/queues'
require 'FoxxMC'

FoxxMC::Utils.defineClasses "#{__dirname}/.."

dataSchema =  joi.object()

###
{

}
###

FoxxMC::Utils.runJob
  context: module.context
  command: (rawData, jobId) ->
    {value:data} = dataSchema.validate rawData

    {read, write} = {{addonPrefix}}::Class.getLocksFor '<some class>.<methodName>'

    db._executeTransaction
      collections:
        read: read
        write: write
        allowImplicit: no
      action: ->
        {{addonPrefix}}::Class.<methodName>
        #<some logic>
        return

    queues._updateQueueDelay()


module.exports = yes
